(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a58b929"],{"1af6":function(e,t,n){var a=n("63b6");a(a.S,"Array",{isArray:n("9003")})},2925:function(e,t,n){},"549b":function(e,t,n){"use strict";var a=n("d864"),o=n("63b6"),r=n("241e"),s=n("b0dc"),i=n("3702"),c=n("b447"),l=n("20fd"),d=n("7cd6");o(o.S+o.F*!n("4ee1")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,o,u,f=r(e),h="function"==typeof this?this:Array,g=arguments.length,m=g>1?arguments[1]:void 0,p=void 0!==m,v=0,b=d(f);if(p&&(m=a(m,g>2?arguments[2]:void 0,2)),void 0==b||h==Array&&i(b))for(t=c(f.length),n=new h(t);t>v;v++)l(n,v,p?m(f[v],v):f[v]);else for(u=b.call(f),n=new h;!(o=u.next()).done;v++)l(n,v,p?s(u,m,[o.value,v],!0):o.value);return n.length=v,n}})},"54a1":function(e,t,n){n("6c1c"),n("1654"),e.exports=n("95d5")},"67bb":function(e,t,n){e.exports=n("f921")},"6e30":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:6}}),e._v(" "),n("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:18}},[n("el-button-group",{staticStyle:{float:"right"}},[n("el-tooltip",{attrs:{placement:"bottom",effect:"light"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),n("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),n("el-checkbox-group",{on:{change:e.handleCheckedInterfacesChange},model:{value:e.checkedInterfaces,callback:function(t){e.checkedInterfaces=t},expression:"checkedInterfaces"}},e._l(e.interfaceList,(function(t){return n("el-checkbox",{key:t.CollInterfaceName,staticStyle:{display:"block",margin:"15px 0"},attrs:{label:t.CollInterfaceName}},[e._v(e._s(t.CollInterfaceName))])})),1)],1),e._v(" "),n("el-button",{attrs:{type:"plain",size:"small"}},[e._v("选择接口 "),n("i",{staticClass:"el-icon-arrow-down el-icon--bottom"})])],1),e._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.timeoutObj,expression:"!timeoutObj"}],attrs:{type:"plain",size:"small",icon:"el-icon-video-play"},on:{click:e.startRealMessage}},[e._v("开始")]),e._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.timeoutObj,expression:"timeoutObj"}],attrs:{type:"plain",size:"small",icon:"el-icon-switch-button"},on:{click:e.stopRealMessage}},[e._v("停止")]),e._v(" "),n("el-button",{attrs:{type:"plain",size:"small",icon:"el-icon-video-pause"},on:{click:e.clearRealMessage}},[e._v("清空")]),e._v(" "),n("el-button",{attrs:{type:"plain",size:"small",icon:"el-icon-download"},on:{click:e.downloadRealMessage}},[e._v("导出")])],1)],1)],1),e._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.realMessageList,"element-loading-text":"加载中",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"数据方向","min-width":"18%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["send"===t.row.DataDirection?n("span",{staticStyle:{color:"coral"}},[e._v(e._s(e._f("dataDirectionFilter")(t.row.DataDirection)))]):n("span",{staticStyle:{color:"green"}},[e._v(e._s(e._f("dataDirectionFilter")(t.row.DataDirection)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"接口名称","min-width":"32%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["send"===t.row.DataDirection?n("span",{staticStyle:{color:"coral"}},[e._v(e._s(t.row.CollInterfaceName))]):n("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.CollInterfaceName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"报文时间","min-width":"25%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["send"===t.row.DataDirection?n("span",{staticStyle:{color:"coral"}},[e._v(e._s(t.row.TimeStamp))]):n("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.TimeStamp))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"报文内容"},scopedSlots:e._u([{key:"default",fn:function(t){return["send"===t.row.DataDirection?n("span",{staticStyle:{color:"coral"}},[e._v(e._s(t.row.DataContent))]):n("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.DataContent))])]}}])})],1)],1)],1)},o=[],r=n("75fc"),s={filters:{statusFilter:function(e){var t={onLine:"success",offLine:"gray",noRegister:"danger"};return t[e]||"info"},interfaceTypeFilter:function(e){var t={LocalSerial:"本地串口",TcpClient:"Tcp客户端",TcpServer:"Tcp服务端"};return t[e]||"未知"},dataDirectionFilter:function(e){var t={send:"发送",receive:"接收"};return t[e]||"未知"},parityFilter:function(e){return console.log(e),"N"===e?"无校验":"J"===e?"奇校验":"O"===e?"偶校验":"未知"}},data:function(){return{realMessageList:[],listLoading:!1,websocket:null,isIndeterminate:!1,checkAll:!1,checkedInterfaces:[],interfaceList:[],timeoutObj:null,downloadLoading:!1}},computed:{filtedInterfaceNames:function(){var e=[];return this.interfaceList.filter((function(t){e.push(t.CollInterfaceName)})),e}},created:function(){this.getAllInterface()},destroyed:function(){clearInterval(this.timeoutObj)},methods:{getAllInterface:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/allInterface",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var n=t.data;"0"===n.Code?(e.interfaceList=n.Data,e.listLoading=!1):"1"===n.Code?(e.$message.error(n.Message),e.listLoading=!1):"-1"===n.Code?(e.listLoading=!1,e.$message.error(n.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+n.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},handleCheckAllChange:function(e){this.checkedInterfaces=e?this.filtedInterfaceNames:[],this.isIndeterminate=!1},handleCheckedInterfacesChange:function(e){var t=e.length;this.checkAll=t===this.filtedInterfaceNames.length,this.isIndeterminate=t>0&&t<this.filtedInterfaceNames.length},startRealMessage:function(){var e=this;0!==this.checkedInterfaces.length?this.timeoutObj=setInterval((function(){e.getRealMessages()}),1e3):this.$message.error("请先选择接口")},stopRealMessage:function(){this.timeoutObj=clearInterval(this.timeoutObj)},clearRealMessage:function(){this.realMessageList=[]},downloadRealMessage:function(){var e=this;this.realMessageList.length?(this.downloadLoading=!0,Promise.all([n.e("chunk-f15d718c"),n.e("chunk-ed7777ae")]).then(n.bind(null,"8530")).then((function(t){var n=["数据方向","接口名称","报文时间","报文内容"],a=["DataDirection","CollInterfaceName","TimeStamp","DataContent"],o=e.realMessageList,r=e.formatJson(a,o);console.log(r),t.export_json_to_excel({header:n,data:r,filename:"实时报文信息"}),e.downloadLoading=!1}))):this.$message({message:"当前列表没有数据",type:"warning"})},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},getRealMessages:function(){var e=this,t={};t.CollInterfaceNames=this.checkedInterfaces;var n="";n="./api/v1/tool/commMessage",this.$axios({method:"post",url:n,data:t,headers:{token:this.$store.getters.token}}).then((function(t){var n=t.data;"0"===n.Code?e.realMessageList=[].concat(Object(r["a"])(e.realMessageList),Object(r["a"])(n.Data)):"1"===n.Code?(e.$message.error(n.Message),e.listLoading=!1):"-1"===n.Code?(e.listLoading=!1,e.$message.error(n.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+n.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},initWebSocket:function(){window.console.log("init WebSocket");var e="ws://127.0.0.1:8001";this.websocket=new WebSocket(e),this.websocket.onmessage=this.onMessage,this.websocket.onopen=this.onOpen,this.websocket.onerror=this.onError,this.websocket.onclose=this.onClose},onOpen:function(){var e={test:"12345"};this.send(JSON.stringify(e))},onError:function(e){window.console.error(e)},onMessage:function(e){window.console.log(e.data)},onClose:function(e){window.console.log("断开连接",e)},send:function(e){this.websocket.send(e)},addCommInterface:function(){var e=this,t="";t="./api/v1/device/addCommInterface",this.$axios({method:"post",url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var n=t.data;"0"===n.Code?e.addVisible=!1:"1"===n.Code?e.$message.error(n.Message):"-1"===n.Code?(e.$message.error(n.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+n.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))}}},i=s,c=(n("fd51"),n("2877")),l=Object(c["a"])(i,a,o,!1,null,"60e3c144",null);t["default"]=l.exports},"75fc":function(e,t,n){"use strict";var a=n("a745"),o=n.n(a);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function s(e){if(o()(e))return r(e)}var i=n("774e"),c=n.n(i),l=n("c8bb"),d=n.n(l),u=n("67bb"),f=n.n(u);function h(e){if("undefined"!==typeof f.a&&d()(Object(e)))return c()(e)}function g(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?c()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e){return s(e)||h(e)||g(e)||m()}n.d(t,"a",(function(){return p}))},"774e":function(e,t,n){e.exports=n("d2d5")},"95d5":function(e,t,n){var a=n("40c3"),o=n("5168")("iterator"),r=n("481b");e.exports=n("584a").isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||r.hasOwnProperty(a(t))}},a745:function(e,t,n){e.exports=n("f410")},c8bb:function(e,t,n){e.exports=n("54a1")},d2d5:function(e,t,n){n("1654"),n("549b"),e.exports=n("584a").Array.from},f410:function(e,t,n){n("1af6"),e.exports=n("584a").Array.isArray},fd51:function(e,t,n){"use strict";var a=n("2925"),o=n.n(a);o.a}}]);