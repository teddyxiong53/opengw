(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e7f8421"],{"0b3d":function(e,t,a){"use strict";var i=a("5bb3"),n=a.n(i);n.a},"36ef":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},n=[],r=(a("28a5"),a("313e")),s=a.n(r);a("817d");var o={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0}},data:function(){return{chart:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=s.a.init(this.$el,"macarons"),this.setOptions(this.chartData)},setOptions:function(e){var t=e.data,a=e.time,i=e.legend;a&&(console.log(e),console.log("test"),this.chart.setOption({xAxis:{data:a,boundaryGap:!1,axisTick:{show:!1},axisLabel:{rotate:0,show:!0,formatter:function(e){return e.split(" ").join("\n")}}},grid:{left:10,right:34,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:i},series:[{name:i,itemStyle:{normal:{color:"#FF005A",lineStyle:{color:"#FF005A",width:2}}},smooth:!0,type:"line",data:t,animationDuration:2800,animationEasing:"cubicInOut"}]}))}}},l=o,c=a("2877"),u=Object(c["a"])(l,i,n,!1,null,null,null);t["a"]=u.exports},"5bb3":function(e,t,a){},"5d58":function(e,t,a){e.exports=a("d8d6")},"67bb":function(e,t,a){e.exports=a("f921")},aa77:function(e,t,a){var i=a("5ca1"),n=a("be13"),r=a("79e5"),s=a("fdef"),o="["+s+"]",l="​",c=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(e,t,a){var n={},o=r((function(){return!!s[e]()||l[e]()!=l})),c=n[e]=o?t(f):s[e];a&&(n[a]=c),i(i.P+i.F*o,"String",n)},f=d.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},ad87:function(e,t,a){},c5f6:function(e,t,a){"use strict";var i=a("7726"),n=a("69a8"),r=a("2d95"),s=a("5dbc"),o=a("6a99"),l=a("79e5"),c=a("9093").f,u=a("11e9").f,d=a("86cc").f,f=a("aa77").trim,h="Number",p=i[h],g=p,v=p.prototype,m=r(a("2aeb")(v))==h,b="trim"in String.prototype,y=function(e){var t=o(e,!1);if("string"==typeof t&&t.length>2){t=b?t.trim():f(t,3);var a,i,n,r=t.charCodeAt(0);if(43===r||45===r){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+t}for(var s,l=t.slice(2),c=0,u=l.length;c<u;c++)if(s=l.charCodeAt(c),s<48||s>n)return NaN;return parseInt(l,i)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof p&&(m?l((function(){v.valueOf.call(a)})):r(a)!=h)?s(new g(y(t)),a,p):y(t)};for(var x,_=a("9e1e")?c(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)n(g,x=_[w])&&!n(p,x)&&d(p,x,u(g,x));p.prototype=v,v.constructor=p,a("2aba")(i,h,p)}},e7be:function(e,t,a){"use strict";var i=a("ad87"),n=a.n(i);n.a},eec8:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:12}},[a("el-button",{attrs:{type:"plain",icon:"el-icon-back",size:"small"},on:{click:e.goBack}},[e._v("设备管理")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v("\n      "+e._s("设备实时监测数据 -- "+(e.deviceInfo?e.deviceInfo.Addr:"无"))+"\n      "),e.deviceInfo?a("el-tag",{attrs:{type:e._f("statusFilter")(e.deviceInfo.CommStatus)}},[e._v(e._s(e._f("netWorkFilter")(e.deviceInfo.CommStatus)))]):e._e()],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"20px","text-align":"right"},attrs:{xs:24,sm:12,md:12}},[a("el-button-group",[a("el-tooltip",{attrs:{effect:"light",content:"刷新",placement:"top-start"}},[a("el-button",{attrs:{type:"plain",icon:"el-icon-refresh"},on:{click:e.handleRefresh}})],1),e._v(" "),a("el-tooltip",{attrs:{effect:"light",content:"切换",placement:"top-start"}},[a("el-button",{attrs:{type:"plain",icon:"el-icon-menu"},on:{click:e.handleChange}})],1)],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.listVisible,expression:"listVisible"}],attrs:{gutter:20}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.nodeVariableList,"element-loading-text":"加载中",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,align:"center",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{label:"变量名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.lable)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量标签",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.name)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.type))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"期望值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.explain))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"实测时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.timestamp))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleClick(t.row)}}},[e._v("查看数据")])]}}])})],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.cardVisible,expression:"cardVisible"}],attrs:{gutter:20}},e._l(e.nodeVariableList,(function(t,i){return a("el-col",{key:i,staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:12,md:6}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.lable))]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(a){return e.handleClick(t)}}},[e._v("查看数据")])],1),e._v(" "),a("el-row",{staticClass:"text item"},[a("el-col",{attrs:{xs:24,sm:24,md:24}},[a("span",[e._v(e._s(t.name))])])],1),e._v(" "),a("el-row",[a("el-col",{staticStyle:{"align-self":"center","text-align":"center"},attrs:{xs:24,sm:24,md:24}},[a("span",{staticStyle:{"font-size":"22px",color:"#333"}},[e._v(e._s(t.value))]),e._v(" "),a("el-tooltip",{attrs:{effect:"light",content:"期望值:"+t.explain,placement:"top-start"}},[a("i",{staticClass:"el-icon-info",staticStyle:{color:"#ccc"}})])],1)],1),e._v(" "),a("div",{staticClass:"bottom clearfix text"},[a("span",[e._v(e._s(t.timestamp))])])],1)],1)})),1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.deviceVarDatasVisible,width:"100%"},on:{"update:visible":function(t){e.deviceVarDatasVisible=t}}},[a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"left"},model:{value:e.beginEndDataTime,callback:function(t){e.beginEndDataTime=t},expression:"beginEndDataTime"}}),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"plain",icon:"el-icon-menu"},on:{click:e.changeHisDatasStyle}})],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.variableHisListVisible,expression:"variableHisListVisible"}],attrs:{gutter:20}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.variableHisList,"element-loading-text":"加载中",border:"",fit:"","highlight-current-row":"",height:"330px"}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,align:"center",label:"序号",width:"55px"}}),e._v(" "),a("el-table-column",{attrs:{label:"时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.TimeStamp))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"原始值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.Value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"期望值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.Explain))])]}}])})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.variableHisChartVisible,expression:"variableHisChartVisible"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("line-chart",{attrs:{"chart-data":e.lineChartData}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deviceVarDatasVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),a("el-tooltip",{attrs:{placement:"top",content:"回到顶部"}},[a("back-to-top",{attrs:{"custom-style":e.myBackToTopStyle,"visibility-height":300,"back-position":50,"transition-name":"fade"}})],1)],1)},n=[],r=(a("7f7f"),a("6b54"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:e.transitionName}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"back-to-ceiling",style:e.customStyle,on:{click:e.backToTop}},[a("svg",{staticClass:"Icon Icon--backToTopArrow",staticStyle:{height:"16px",width:"16px"},attrs:{width:"16",height:"16",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"}},[a("path",{attrs:{d:"M12.036 15.59a1 1 0 0 1-.997.995H5.032a.996.996 0 0 1-.997-.996V8.584H1.03c-1.1 0-1.36-.633-.578-1.416L7.33.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.004z"}})])])])}),s=[],o=(a("c5f6"),{name:"BackToTop",props:{visibilityHeight:{type:Number,default:400},backPosition:{type:Number,default:0},customStyle:{type:Object,default:function(){return{right:"50px",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#e7eaf1"}}},transitionName:{type:String,default:"fade"}},data:function(){return{visible:!1,interval:null,isMoving:!1}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll),this.interval&&clearInterval(this.interval)},methods:{handleScroll:function(){this.visible=window.pageYOffset>this.visibilityHeight},backToTop:function(){var e=this;if(!this.isMoving){var t=window.pageYOffset,a=0;this.isMoving=!0,this.interval=setInterval((function(){var i=Math.floor(e.easeInOutQuad(10*a,t,-t,500));i<=e.backPosition?(window.scrollTo(0,e.backPosition),clearInterval(e.interval),e.isMoving=!1):window.scrollTo(0,i),a++}),16.7)}},easeInOutQuad:function(e,t,a,i){return(e/=i/2)<1?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t}}}),l=o,c=(a("e7be"),a("2877")),u=Object(c["a"])(l,r,s,!1,null,"053f1ae1",null),d=u.exports,f=a("36ef"),h=(a("28a5"),a("a481"),a("5d58")),p=a.n(h),g=a("67bb"),v=a.n(g);function m(e){return m="function"===typeof v.a&&"symbol"===typeof p.a?function(e){return typeof e}:function(e){return e&&"function"===typeof v.a&&e.constructor===v.a&&e!==v.a.prototype?"symbol":typeof e},m(e)}function b(e,t){if(0===arguments.length)return null;var a,i=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===m(e)?a=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),a=new Date(e));var n={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()},r=i.replace(/{(y|m|d|h|i|s|a)+}/g,(function(e,t){var a=n[t];return"a"===t?["日","一","二","三","四","五","六"][a]:(e.length>0&&a<10&&(a="0"+a),a||0)}));return r}var y={components:{BackToTop:d,LineChart:f["a"]},filters:{statusFilter:function(e){var t={onLine:"success",offLine:"gray",noRegister:"danger"};return t[e]||"info"},interfaceTypeFilter:function(e){var t={LocalSerial:"本地串口",TcpClient:"Tcp客户端",TcpServer:"Tcp服务端"};return t[e]||"未知"},netWorkFilter:function(e){var t={onLine:"在线",noRegister:"未注册",offLine:"离线"};return t[e]||"未知"},parityFilter:function(e){return console.log(e),"N"===e?"无校验":"J"===e?"奇校验":"O"===e?"偶校验":"未知"}},data:function(){return{nodeVariableList:[],variableHisList:[],listLoading:!0,currentCollInterfaceName:"",currentDeviceAddr:"",currentVariableName:"",deviceInfo:{},listVisible:!0,cardVisible:!1,variableHisListVisible:!1,variableHisChartVisible:!0,myBackToTopStyle:{right:"50px",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#e7eaf1"},title:"",deviceVarDatasVisible:!1,beginEndDataTime:"",pickerOptions:{shortcuts:[{text:"最近一小时",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-36e5),e.$emit("pick",[a,t])}},{text:"最近一天",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-864e5),e.$emit("pick",[a,t])}},{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}}]}}},computed:{lineChartData:function(){var e=this.currentVariableName,t=this.variableHisList,a=[],i=[],n=[];console.log("dataPoint"+t.length),this.beginEndDataTime&&console.log(b(this.beginEndDataTime[0]));for(var r=0;r<t.length;r++){var s=t[r];parseFloat(s.Value)&&(a.push(parseFloat(s.Value)),i.push(s.TimeStamp.toString()))}return e&&n.push(e.toString()),{data:a,time:i,legend:n}},filtedData:function(){var e=this;return this.variableHisList.filter((function(t){return e.beginEndDataTime?t.TimeStamp.toString().indexOf(e.currentVariableName)>-1||t.TimeStamp.toString().indexOf(e.currentVariableName)>-1||t.TimeStamp.toString().indexOf(e.currentVariableName)>-1?t:void 0:t}))}},created:function(){var e=this.$route.params;this.currentCollInterfaceName=e.CollInterfaceName,this.deviceInfo=e.deviceInfo,this.currentCollInterfaceName&&this.deviceInfo.Addr?this.getNodeVariable():this.$router.push("/config/interface")},methods:{getNodeVariable:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/nodeVariable",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName,Addr:e.deviceInfo.Addr},headers:{token:this.$store.getters.token}}).then((function(t){var a=t.data;"0"===a.Code?(e.nodeVariableList=a.Data,e.listLoading=!1):"1"===a.Code?(e.$message.error(a.Message),e.listLoading=!1):"-1"===a.Code?(e.listLoading=!1,e.$message.error(a.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+a.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},indexMethod:function(e){return e+1},goBack:function(){var e=this;this.$router.push({name:"deviceManager",params:{CollInterfaceName:e.currentCollInterfaceName}})},handleRefresh:function(){this.currentCollInterfaceName&&this.deviceInfo.Addr?this.getNodeVariable():this.$router.push("/config/interface")},handleChange:function(){this.listVisible=!this.listVisible,this.cardVisible=!this.cardVisible},changeHisDatasStyle:function(){this.variableHisListVisible=!this.variableHisListVisible,this.variableHisChartVisible=!this.variableHisChartVisible},handleSetLineChartData:function(e){var t=this,a="";a="./api/v1/system/"+e,this.$axios({method:"get",url:a,headers:{token:this.$store.getters.token}}).then((function(e){var a=e.data;if("0"===a.Code){for(var i=a.Data.Legend,n=a.Data.DataPoint,r=[],s=[],o=[],l=0;l<n.length;l++){var c=n[l];parseFloat(c.Value)&&(r.push(parseFloat(c.Value)),s.push(c.Time.toString()))}i&&o.push(i.toString()),t.lineChartData={data:r,time:s,legend:o}}else"1"===a.Code?t.$message.error(a.Message):"-1"===a.Code?(t.$message.error(a.Message),t.$store.dispatch("user/resetToken"),t.$router.push("/login?redirect=".concat(t.$route.fullPath))):t.$message.error("返回未知错误，错误码："+a.Code)})).catch((function(e){t.$message.error("出错了"+JSON.stringify(e))}))},handleClick:function(e){this.deviceVarDatasVisible=!0,this.title="查看数据 "+e.name+"("+e.lable+")",this.currentVariableName=e.name,this.getVariableHisDatas()},getVariableHisDatas:function(){var e=this,t="";t="./api/v1/device/nodeHistoryVariable",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName,Addr:e.deviceInfo.Addr,VariableName:e.currentVariableName},headers:{token:this.$store.getters.token}}).then((function(t){var a=t.data;"0"===a.Code?e.variableHisList=a.Data:"1"===a.Code?e.$message.error(a.Message):"-1"===a.Code?(e.$message.error(a.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+a.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))}}},x=y,_=(a("0b3d"),Object(c["a"])(x,i,n,!1,null,"c31a4ffa",null));t["default"]=_.exports},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);