(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20304940"],{"0be8":function(e,t,a){"use strict";var i=a("d728"),s=a.n(i);s.a},3846:function(e,t,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"6b54":function(e,t,a){"use strict";a("3846");var i=a("cb7c"),s=a("0bfb"),r=a("9e1e"),n="toString",o=/./[n],l=function(e){a("2aba")(RegExp.prototype,n,e,!0)};a("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?l((function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?s.call(e):void 0)})):o.name!=n&&l((function(){return o.call(this)}))},"8f6a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"100%"}},[a("iframe",{directives:[{name:"show",rawName:"v-show",value:e.iframeVisible,expression:"iframeVisible"}],ref:e.iframeId,attrs:{id:e.iframeId,src:e.iframeSrc,width:"100%",height:"525px",frameborder:"0",scrolling:"no"}})])])},s=[],r=(a("7f7f"),a("6b54"),{components:{},filters:{},data:function(){return{nodeVariableList:[],avatar:"serialHelper",buttonVisible:!1,iframeWin:null,iframTitle:"",iframeVisible:!1,iframeSrc:"",iframeId:"",sysToolName:"",variableHisList:[],loading:!0,timeoutObj:null,title:""}},computed:{},created:function(){var e=this.$route.query;e&&e.sysToolName?(this.sysToolName=e.sysToolName,this.iframeVisible=!0,this.iframeId=this.sysToolName+"_iframe",this.iframeSrc=this.sysToolName+"/index.html",console.log(this.iframeSrc)):this.$message.error("未知工具");var t=sessionStorage.getItem("sysToolName");console.log(t)},mounted:function(){window.addEventListener("message",this.handleMessage);var e=this.$refs[this.iframeId],t=this;e&&(e.attachEvent?e.attachEvent("onload",(function(){t.loading=!1,t.iframeWin=t.$refs[t.iframeId].contentWindow})):e.onload=function(){t.loading=!1,t.iframeWin=t.$refs[t.iframeId].contentWindow})},methods:{detail:function(){alert("11111")},getAllInterface:function(){var e=this,t="";t="./api/v1/device/allInterface",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var a=t.data;"0"===a.Code?e.iframeWin.postMessage({cmd:"getSerials",params:{interfaceList:a.Data}},"*"):"1"===a.Code?e.$message.error(a.Message):"-1"===a.Code?(e.$message.error(a.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+a.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},sendDirectData:function(e,t){var a=this,i="";i="./api/v1/device/interface/directData",this.$axios({method:"post",url:i,data:{CollInterfaceName:e,DirectData:t},headers:{token:this.$store.getters.token}}).then((function(e){var t=e.data;"0"===t.Code?a.iframeWin.postMessage({cmd:"getReceiveDirectData",params:{receiveDirectData:t.Data}},"*"):"1"===t.Code?a.$message.error(t.Message):"-1"===t.Code?(a.$message.error(t.Message),a.$store.dispatch("user/resetToken"),a.$router.push("/login?redirect=".concat(a.$route.fullPath))):a.$message.error("返回未知错误，错误码："+t.Code)})).catch((function(e){a.$message.error("出错了"+JSON.stringify(e)),a.listLoading=!1}))},enterIframe:function(){var e=this;this.iframTitle="串口助手",this.sysToolName="serialHelper",this.iframeVisible=!0,this.iframeId=this.sysToolName+"_iframe",this.iframeSrc=this.sysToolName+"/index.html",this.timeoutObj=setInterval((function(){e.createIframeWin()}),1e3)},createIframeWin:function(){this.$refs[this.iframeId]&&(clearInterval(this.timeoutObj),this.iframeWin=this.$refs[this.iframeId].contentWindow,this.getAllInterface())},sendBw:function(e){this.iframeWin.postMessage({cmd:"receiveData",params:{receiveData:e}},"*")},handleMessage:function(e){var t=e.data;switch(t.cmd){case"getSerials":this.getAllInterface();break;case"sendData":t.params&&this.sendBw(t.params.sendContent);break;case"sendDirectData":t.params&&(t.params.CollInterfaceName&&t.params.DirectData?this.sendDirectData(t.params.CollInterfaceName,t.params.DirectData):this.$message.error("接口或者发送数据为空"));break}},mouseenter:function(){this.buttonVisible=!0},mouseleave:function(){this.buttonVisible=!1},getNodeVariable:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/nodeVariable",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName,Addr:e.deviceInfo.Addr},headers:{token:this.$store.getters.token}}).then((function(t){var a=t.data;"0"===a.Code?(e.nodeVariableList=a.Data,e.listLoading=!1):"1"===a.Code?(e.$message.error(a.Message),e.listLoading=!1):"-1"===a.Code?(e.listLoading=!1,e.$message.error(a.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+a.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},indexMethod:function(e){return e+1},goBack:function(){var e=this;this.$router.push({name:"deviceManager",params:{CollInterfaceName:e.currentCollInterfaceName}})},handleRefresh:function(){this.currentCollInterfaceName&&this.deviceInfo.Addr?this.getNodeVariable():this.$router.push("/config/interface")},handleChange:function(){this.listVisible=!this.listVisible,this.cardVisible=!this.cardVisible},changeHisDatasStyle:function(){this.variableHisListVisible=!this.variableHisListVisible,this.variableHisChartVisible=!this.variableHisChartVisible},handleSetLineChartData:function(e){var t=this,a="";a="./api/v1/system/"+e,this.$axios({method:"get",url:a,headers:{token:this.$store.getters.token}}).then((function(e){var a=e.data;if("0"===a.Code){for(var i=a.Data.Legend,s=a.Data.DataPoint,r=[],n=[],o=[],l=0;l<s.length;l++){var c=s[l];parseFloat(c.Value)&&(r.push(parseFloat(c.Value)),n.push(c.Time.toString()))}i&&o.push(i.toString()),t.lineChartData={data:r,time:n,legend:o}}else"1"===a.Code?t.$message.error(a.Message):"-1"===a.Code?(t.$message.error(a.Message),t.$store.dispatch("user/resetToken"),t.$router.push("/login?redirect=".concat(t.$route.fullPath))):t.$message.error("返回未知错误，错误码："+a.Code)})).catch((function(e){t.$message.error("出错了"+JSON.stringify(e))}))},handleClick:function(e){this.deviceVarDatasVisible=!0,this.title="查看数据 "+e.name+"("+e.lable+")",this.currentVariableName=e.name,this.getVariableHisDatas()},getVariableHisDatas:function(){var e=this,t="";t="./api/v1/device/nodeHistoryVariable",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName,Addr:e.deviceInfo.Addr,VariableName:e.currentVariableName},headers:{token:this.$store.getters.token}}).then((function(t){var a=t.data;"0"===a.Code?e.variableHisList=a.Data:"1"===a.Code?e.$message.error(a.Message):"-1"===a.Code?(e.$message.error(a.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+a.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))}}}),n=r,o=(a("0be8"),a("2877")),l=Object(o["a"])(n,i,s,!1,null,"53728392",null);t["default"]=l.exports},d728:function(e,t,a){}}]);