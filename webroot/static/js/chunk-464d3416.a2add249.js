(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-464d3416"],{"1c20":function(e,t,r){},3846:function(e,t,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},4983:function(e,t,r){"use strict";var i=r("1c20"),o=r.n(i);o.a},"6b54":function(e,t,r){"use strict";r("3846");var i=r("cb7c"),o=r("0bfb"),a=r("9e1e"),s="toString",n=/./[s],l=function(e){r("2aba")(RegExp.prototype,s,e,!0)};r("79e5")((function(){return"/a/b"!=n.call({source:"a",flags:"b"})}))?l((function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?o.call(e):void 0)})):n.name!=s&&l((function(){return n.call(this)}))},b88a:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:12}},[r("el-row",{attrs:{gutter:20}},[r("div",[r("el-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary",icon:"el-icon-back"},on:{click:e.goBackToInterface}},[e._v(e._s("采集接口"))]),e._v(" "),r("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"输入地址/名称/状态过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)])],1),e._v(" "),r("el-col",{staticStyle:{"margin-bottom":"20px","text-align":"right"},attrs:{xs:24,sm:12,md:12}},[r("el-button-group",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddDevice}},[e._v("添加")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleModifyDevice}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleDeleteDevice}},[e._v("删除")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.getDeviceListByInterface}},[e._v("刷新")])],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:12,md:12}},[r("span",{staticStyle:{"font-size":"20px","align-self":"center","margin-right":"15px"}},[e._v(e._s(e.currentCollInterfaceName))]),e._v(" "),r("span",{staticStyle:{"margin-right":"15px","align-self":"bottom"}},[e._v("设备总数："),r("span",{staticStyle:{color:"#006db1"}},[e._v(e._s(e.currentCollInterfaceDeviceNodeInfo.DeviceNodeCnt?e.currentCollInterfaceDeviceNodeInfo.DeviceNodeCnt:"0"))])]),e._v(" "),r("span",{staticStyle:{"align-self":"bottom"}},[e._v("在线："),r("span",{staticStyle:{color:"green"}},[e._v(e._s(e.currentCollInterfaceDeviceNodeInfo.DeviceNodeOnlineCnt?e.currentCollInterfaceDeviceNodeInfo.DeviceNodeOnlineCnt:"0"))])])])],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.filtedData,"element-loading-text":"加载中",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"设备名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.Name+"(")+"\n          "),r("el-tag",{attrs:{type:e._f("statusFilter")(t.row.CommStatus)}},[e._v(e._s(e._f("netWorkFilter")(t.row.CommStatus)))]),e._v("\n          "+e._s(")")+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"设备模型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.Type)+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"通讯地址",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.Addr))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"最后通信时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.LastCommRTC))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"通信总次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.CommTotalCnt))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"通信成功次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.CommSuccessCnt))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row,"deviceRealVariable")}}},[e._v("查看变量")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row,"deviceDebug")}}},[e._v("设备调试")])]}}])})],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.title,visible:e.deviceVisible,width:"30%"},on:{"update:visible":function(t){e.deviceVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"设备名称"}},[r("el-input",{attrs:{disabled:"put"===e.mode},model:{value:e.form.Name,callback:function(t){e.$set(e.form,"Name",t)},expression:"form.Name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"设备模型"}},[r("el-select",{attrs:{clearable:"",placeholder:"请输入设备模型"},model:{value:e.form.Type,callback:function(t){e.$set(e.form,"Type",t)},expression:"form.Type"}},e._l(e.templateList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.Name,value:e.Name}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"采集接口"}},[r("el-input",{attrs:{placeholder:"请输入采集接口",disabled:!0},model:{value:e.form.CollInterfaceName,callback:function(t){e.$set(e.form,"CollInterfaceName",t)},expression:"form.CollInterfaceName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"通讯地址"}},[r("el-input",{attrs:{placeholder:"请输入通讯地址",type:"number"},model:{value:e.form.Addr,callback:function(t){e.$set(e.form,"Addr",t)},expression:"form.Addr"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.deviceVisible=!1,e.form={}}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addDevice}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"批量修改设备",visible:e.batchModifyDeviceVisible,width:"30%"},on:{"update:visible":function(t){e.batchModifyDeviceVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"设备模型"}},[r("el-select",{attrs:{clearable:"",placeholder:"请输入设备模型"},model:{value:e.form.Type,callback:function(t){e.$set(e.form,"Type",t)},expression:"form.Type"}},e._l(e.templateList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.Name,value:e.Name}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"采集接口"}},[r("el-input",{attrs:{placeholder:"请输入采集接口",disabled:!0},model:{value:e.form.CollInterfaceName,callback:function(t){e.$set(e.form,"CollInterfaceName",t)},expression:"form.CollInterfaceName"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.batchModifyDeviceVisible=!1,e.form={}}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.batchModifyDevice}},[e._v("确 定")])],1)],1)],1)},o=[],a=(r("6b54"),{filters:{statusFilter:function(e){var t={onLine:"success",offLine:"gray",noRegister:"danger"};return t[e]||"info"},interfaceTypeFilter:function(e){var t={LocalSerial:"本地串口",TcpClient:"Tcp客户端",TcpServer:"Tcp服务端"};return t[e]||"未知"},netWorkFilter:function(e){var t={onLine:"在线",noRegister:"未注册",offLine:"离线"};return t[e]||"未知"},parityFilter:function(e){return console.log(e),"N"===e?"无校验":"J"===e?"奇校验":"O"===e?"偶校验":"未知"}},data:function(){return{deviceListByCollInterface:[],listLoading:!0,form:{},filterText:"",editVisible:!1,baudRateList:[],ParityList:[],InterfaceTypeList:[],addVisible:!1,interface:[],activeNames:"11",interfaceList:[],InterfaceMap:[],mode:"",title:"",deviceVisible:!1,templateList:[],currentCollInterfaceName:"",multipleSelection:[],batchModifyDeviceVisible:!1}},computed:{filtedData:function(){var e=this;return this.deviceListByCollInterface.filter((function(t){if(t.Addr.toString().indexOf(e.filterText)>-1||t.Name.toString().indexOf(e.filterText)>-1||t.CommStatus.toString().indexOf(e.filterText)>-1)return t}))},deviceCntInfo:function(){var e=0,t=0,r={};return this.interfaceList.filter((function(r){e+=parseInt(r.DeviceNodeCnt),t+=parseInt(r.DeviceNodeOnlineCnt)})),r.deviceCnt=e,r.deviceOnlineCnt=t,r},currentCollInterfaceDeviceNodeInfo:function(){var e=0,t={};return this.deviceListByCollInterface.filter((function(t){"onLine"===t.CommStatus&&(e+=1)})),t.DeviceNodeCnt=this.deviceListByCollInterface.length,t.DeviceNodeOnlineCnt=e,t}},created:function(){this.getAllInterface();var e=this.$route.params;console.log(e),e&&e.CollInterfaceName?(this.currentCollInterfaceName=e.CollInterfaceName,this.getDeviceListByInterface()):this.$router.push("/config/interface")},methods:{getAllInterface:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/allInterface",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.interfaceList=r.Data,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},addInterface:function(){var e=this,t="";t="./api/v1/device/interface",this.$axios({method:e.mode,url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.addVisible=!1,"post"===e.mode&&e.$message.success("添加采集接口成功"),"put"===e.mode&&e.$message.success("修改采集接口成功"),"delete"===e.mode&&e.$message.success("删除采集接口成功")):"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},addDevice:function(){var e=this,t="";t="./api/v1/device/node",this.$axios({method:e.mode,url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.addVisible=!1,"post"===e.mode&&(e.$message.success("添加设备成功"),e.deviceVisible=!1,e.getDeviceListByInterface()),"put"===e.mode&&(e.$message.success("修改设备成功"),e.deviceVisible=!1,e.getDeviceListByInterface()),"delete"===e.mode&&(e.$message.success("删除设备成功"),e.deviceVisible=!1,e.getDeviceListByInterface())):"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},getAllCommInterface:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/commInterface",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.InterfaceMap=r.Data.InterfaceMap,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},getAllDeviceModel:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/tsl",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.templateList=r.Data,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},getAllTemplate:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/template",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.templateList=r.Data,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},goBackToInterface:function(){this.$router.push("/config/interface")},getDeviceListByInterface:function(){var e=this,t="";t="./api/v1/device/interface",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName},headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?e.deviceListByCollInterface=r.Data.DeviceNodeMap:"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},handleClick:function(e,t){var r=this;this.$router.push({name:t,params:{CollInterfaceName:r.currentCollInterfaceName,Addr:e.Addr,deviceInfo:e}})},handleEdit:function(e,t){this.form=t,this.editVisible=!0},handleAddDevice:function(){this.deviceVisible=!0,this.getAllDeviceModel(),this.title="添加设备",this.form.CollInterfaceName=this.currentCollInterfaceName,this.mode="post"},handleModifyDevice:function(){if(this.selectDeviceNames=[],this.form={},this.mode="put",this.multipleSelection.length<1)this.$message.error("请至少选择一个设备");else{if(1===this.multipleSelection.length)return this.deviceVisible=!0,this.getAllDeviceModel(),this.title="修改设备",this.form.CollInterfaceName=this.currentCollInterfaceName,this.form.Name=this.multipleSelection[0].Name,this.$set(this.form,"Addr",this.multipleSelection[0].Addr),this.$set(this.form,"Type",this.multipleSelection[0].Type),void(this.mode="put");this.getAllDeviceModel();var e=[];this.multipleSelection.filter((function(t){t.Name&&e.push(t.Name)})),e.length<1?this.$message.error("选择的设备无名称"):(this.selectDeviceNames=e,this.batchModifyDeviceVisible=!0,this.form.CollInterfaceName=this.currentCollInterfaceName)}},handleDeleteDevice:function(){if(this.selectDeviceNames=[],this.multipleSelection.length<1)this.$message.error("请至少选择一个设备");else{var e=[];if(this.multipleSelection.filter((function(t){t.Name&&e.push(t.Name)})),e.length<1)this.$message.error("选择的设备无名称");else{this.selectDeviceNames=e;var t=this;this.$messageBox.confirm("你确定要删除这些设备吗？<br />","删除设备",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,dangerouslyUseHTMLString:!0,type:"info"}).then((function(e){"confirm"===e&&(t.mode="delete",t.batchModifyDevice(),t.getDeviceListByInterface())})).catch((function(e){"cancel"===e&&t.getDeviceListByInterface()}))}}},batchModifyDevice:function(){var e=this,t={},r="";"put"===this.mode&&(t.CollInterfaceName=e.currentCollInterfaceName,t.Name=e.selectDeviceNames,t.Type=e.form.Type,r="nodes"),"delete"===this.mode&&(t.CollInterfaceName=e.currentCollInterfaceName,t.Name=e.selectDeviceNames,r="node");var i="";i="./api/v1/device/"+r,this.$axios({method:e.mode,url:i,data:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?e.batchModifyDeviceVisible=!1:"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},handleSelectionChange:function(e){this.multipleSelection=e},addCommInterface:function(){var e=this,t="";t="./api/v1/device/addCommInterface",this.$axios({method:"post",url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?e.addVisible=!1:"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))}}}),s=a,n=(r("4983"),r("2877")),l=Object(n["a"])(s,i,o,!1,null,"01380214",null);t["default"]=l.exports}}]);