(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04ce602b"],{"22ec":function(e,t,r){"use strict";var o=r("30c0"),a=r.n(o);a.a},"30c0":function(e,t,r){},3846:function(e,t,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},"6b54":function(e,t,r){"use strict";r("3846");var o=r("cb7c"),a=r("0bfb"),i=r("9e1e"),n="toString",s=/./[n],l=function(e){r("2aba")(RegExp.prototype,n,e,!0)};r("79e5")((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?l((function(){var e=o(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?a.call(e):void 0)})):s.name!=n&&l((function(){return s.call(this)}))},e3a9:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:12}},[r("el-row",{attrs:{gutter:20}},[r("div",[r("el-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary",icon:"el-icon-back"},on:{click:e.goBackToDeviceModel}},[e._v(e._s("设备模型"))]),e._v(" "),r("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"输入地址/名称/状态过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)])],1),e._v(" "),r("el-col",{staticStyle:{"margin-bottom":"20px","text-align":"right"},attrs:{xs:24,sm:12,md:12}},[r("el-button-group",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddFunction}},[e._v("添加")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.getCustomFunctionListByDeviceModel}},[e._v("刷新")])],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:12,md:12}},[r("span",{staticStyle:{"font-size":"20px","align-self":"center","margin-right":"15px"}},[e._v(e._s(e.currentDeviceModelName))])])],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"calc(100% - 55px)","overflow-y":"auto"},attrs:{data:e.functionList.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),stripe:!0,"max-height":"1024","element-loading-text":"加载中",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{type:"index",index:e.indexMethod,align:"center",label:"序号",width:"55px"}}),e._v(" "),r("el-table-column",{attrs:{label:"功能类型",align:"center",width:"95px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:e._f("functionTypeTagFilter")(t.row.FunctionType)}},[e._v(e._s(e._f("functionTypeFilter")(t.row.FunctionType)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"功能名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.Explain)+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"标识符",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.Name))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"数据类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("dataTypeFilter")(t.row.Type)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"数据定义",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.Params["Min"]&&null!=t.row.Params["Max"]?r("div",[r("span",[e._v(e._s("数值范围："+t.row.Params["Min"]+"-"+t.row.Params["Max"]))])]):e._e(),e._v(" "),null!=t.row.Params["Step"]?r("div",[r("span",[e._v(e._s("步长:"+t.row.Params["Step"]))])]):e._e(),e._v(" "),null!=t.row.Params["CallType"]?r("div",[r("span",[e._v(e._s("调用方式:"+("0"==t.row.Params["CallType"]?"同步":"异步")))])]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row,"edit")}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row,"delete")}}},[e._v("删除")])]}}])})],1),e._v(" "),r("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.functionList.length,"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":1},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.title,visible:e.functionVisible,width:"30%"},on:{"update:visible":function(t){e.functionVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"功能类型"}},[r("el-radio-group",{attrs:{size:"medium"},model:{value:e.form.functionType,callback:function(t){e.$set(e.form,"functionType",t)},expression:"form.functionType"}},[r("el-radio-button",{attrs:{label:"property"}},[e._v("属性")]),e._v(" "),r("el-radio-button",{attrs:{label:"service"}},[e._v("服务")]),e._v(" "),r("el-radio-button",{attrs:{label:"event"}},[e._v("事件")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"功能名称"}},[r("el-input",{attrs:{placeholder:"请输入功能名称"},model:{value:e.form.Explain,callback:function(t){e.$set(e.form,"Explain",t)},expression:"form.Explain"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"标识符"}},[r("el-input",{attrs:{placeholder:"请输入您的标识符"},model:{value:e.form.Name,callback:function(t){e.$set(e.form,"Name",t)},expression:"form.Name"}})],1),e._v(" "),"property"==e.form.functionType?r("el-form-item",{attrs:{label:"数据类型"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择数据类型"},model:{value:e.form.dataType,callback:function(t){e.$set(e.form,"dataType",t)},expression:"form.dataType"}},e._l(e.dataTypeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.text,value:e.id}})})),1)],1):e._e(),e._v(" "),"property"!=e.form.functionType||"0"!=e.form.dataType&&"1"!=e.form.dataType&&"2"!=e.form.dataType?e._e():r("el-form-item",{attrs:{label:"取值范围"}},[r("el-col",{attrs:{span:11}},[r("el-input",{attrs:{placeholder:"最小值"},model:{value:e.form.Min,callback:function(t){e.$set(e.form,"Min",t)},expression:"form.Min"}})],1),e._v(" "),r("el-col",{attrs:{span:2}},[r("label",{staticStyle:{margin:"0px 8px"}},[e._v("~")])]),e._v(" "),r("el-col",{attrs:{span:11}},[r("el-input",{attrs:{placeholder:"最大值"},model:{value:e.form.Max,callback:function(t){e.$set(e.form,"Max",t)},expression:"form.Max"}})],1)],1),e._v(" "),"property"!=e.form.functionType||"0"!=e.form.dataType&&"1"!=e.form.dataType&&"2"!=e.form.dataType?e._e():r("el-form-item",{attrs:{label:"步长"}},[r("el-input",{attrs:{placeholder:"请输入步长"},model:{value:e.form.Unit,callback:function(t){e.$set(e.form,"Unit",t)},expression:"form.Unit"}})],1),e._v(" "),"property"!=e.form.functionType||"0"!=e.form.dataType&&"1"!=e.form.dataType&&"2"!=e.form.dataType?e._e():r("el-form-item",{attrs:{label:"单位"}},[r("el-input",{attrs:{placeholder:"请输入您的单位"},model:{value:e.form.Unit,callback:function(t){e.$set(e.form,"Unit",t)},expression:"form.Unit"}})],1),e._v(" "),"property"==e.form.functionType&&"3"==e.form.dataType?r("el-form-item",{attrs:{label:"数据长度"}},[r("el-input",{attrs:{placeholder:"请输入数据长度"},model:{value:e.form.DataLength,callback:function(t){e.$set(e.form,"DataLength",t)},expression:"form.DataLength"}})],1):e._e(),e._v(" "),"property"==e.form.functionType?r("el-form-item",{attrs:{label:"读写类型"}},[r("el-radio-group",{model:{value:e.form.AccessMode,callback:function(t){e.$set(e.form,"AccessMode",t)},expression:"form.AccessMode"}},[r("el-radio",{attrs:{label:0}},[e._v("只读")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("只写")]),e._v(" "),r("el-radio",{attrs:{label:2}},[e._v("读写")])],1)],1):e._e(),e._v(" "),"service"==e.form.functionType?r("el-form-item",{attrs:{label:"调用方式"}},[r("el-radio-group",{model:{value:e.form.AccessMode,callback:function(t){e.$set(e.form,"AccessMode",t)},expression:"form.AccessMode"}},[r("el-radio",{attrs:{label:0}},[e._v("同步")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("异步")])],1)],1):e._e()],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.functionVisible=!1,e.form={}}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addDevice}},[e._v("确 定")])],1)],1)],1)},a=[],i=(r("6b54"),{filters:{functionTypeTagFilter:function(e){var t={property:"success",service:"gray",event:"danger"};return t[e]||"info"},functionTypeFilter:function(e){var t={property:"属性",service:"服务",event:"事件"};return t[e]||"未知"},dataTypeFilter:function(e){var t={0:"uint32",1:"int32",2:"double",3:"string"};return t[e]||"未知"},paramFilter:function(e){var t="";for(var r in e["Min"]&&e["Max"]&&(t=t+"数值范围："+e["Min"]+"-"+e["Max"]+"<br>"),e)"Step"===r?t=t+"步长:"+e[r]+"<br>":"Unit"===r?t=t+"单位:"+e[r]+"<br>":"Decimals"===r&&(t=t+"小数位:"+e[r]+"<br>");return t||"无"}},data:function(){return{deviceListByCollInterface:[],listLoading:!1,form:{},filterText:"",currentDeviceModelName:"",editVisible:!1,functionVisible:!1,functionTypeList:[],dataTypeList:[],addVisible:!1,interface:[],activeNames:"11",functionList:[],InterfaceMap:[],mode:"",title:"",currentPage:1,pagesize:5,multipleSelection:[]}},computed:{filtedData:function(){var e=this;return this.deviceListByCollInterface.filter((function(t){if(t.Addr.toString().indexOf(e.filterText)>-1||t.Name.toString().indexOf(e.filterText)>-1||t.CommStatus.toString().indexOf(e.filterText)>-1)return t}))},functionCntInfo:function(){var e=0,t=0,r={};return this.functionList.filter((function(r){"property"===r.FunctionType&&(e+=1),"service"===r.FunctionType&&(t+=1)})),r.propertyCnt=e,r.serviceCnt=t,r},currentCollInterfaceDeviceNodeInfo:function(){var e=0,t={};return this.deviceListByCollInterface.filter((function(t){"onLine"===t.CommStatus&&(e+=1)})),t.DeviceNodeCnt=this.deviceListByCollInterface.length,t.DeviceNodeOnlineCnt=e,t}},created:function(){var e=this.$route.params;console.log(e),e&&e.deviceModel?(this.currentDeviceModelName=e.deviceModel.Name,this.getCustomFunctionListByDeviceModel(),this.functionTypeList=[{id:"property",text:"属性"},{id:"service",text:"服务"},{id:"event",text:"事件"}],this.dataTypeList=[{id:"0",text:"uint32"},{id:"1",text:"int32"},{id:"2",text:"double"},{id:"3",text:"string"}]):this.$router.push("deviceModel")},methods:{getCustomFunctionListByDeviceModel:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/tsl/contents",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;if("0"===r.Code){for(var o=r.Data.Properties,a=r.Data.Services,i=0;i<o.length;i++)o[i].FunctionType="property",e.functionList.push(o[i]);for(var n=0;n<a.length;n++)a[n].FunctionType="service",e.functionList.push(a[n]);e.listLoading=!1}else"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},indexMethod:function(e){return e+1},addInterface:function(){var e=this,t="";t="./api/v1/device/interface",this.$axios({method:e.mode,url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.addVisible=!1,"post"===e.mode&&e.$message.success("添加采集接口成功"),"put"===e.mode&&e.$message.success("修改采集接口成功"),"delete"===e.mode&&e.$message.success("删除采集接口成功")):"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},addDevice:function(){var e=this,t="";t="./api/v1/device/node",this.$axios({method:e.mode,url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.addVisible=!1,"post"===e.mode&&(e.$message.success("添加设备成功"),e.deviceVisible=!1),"put"===e.mode&&(e.$message.success("修改设备成功"),e.deviceVisible=!1),"delete"===e.mode&&(e.$message.success("删除设备成功"),e.deviceVisible=!1)):"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},getAllCommInterface:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/commInterface",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.InterfaceMap=r.Data.InterfaceMap,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},getAllTemplate:function(){this.listLoading=!0;var e=this,t="";t="./api/v1/device/template",this.$axios({method:"get",url:t,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?(e.templateList=r.Data,e.listLoading=!1):"1"===r.Code?(e.$message.error(r.Message),e.listLoading=!1):"-1"===r.Code?(e.listLoading=!1,e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):(e.$message.error("返回未知错误，错误码："+r.Code),e.listLoading=!1)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t)),e.listLoading=!1}))},goBackToDeviceModel:function(){this.$router.push("/config/deviceModel")},getDeviceListByInterface:function(){var e=this,t="";t="./api/v1/device/interface",this.$axios({method:"get",url:t,params:{CollInterfaceName:e.currentCollInterfaceName},headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?e.deviceListByCollInterface=r.Data.DeviceNodeMap:"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))},handleClick:function(e,t){console.log(e)},handleEdit:function(e,t){this.form=t,this.editVisible=!0},handleAddFunction:function(){this.functionVisible=!0,this.title="添加自定义功能",this.form.deviceModelName=this.currentDeviceModelName,this.$set(this.form,"functionType","property"),this.mode="post"},addCommInterface:function(){var e=this,t="";t="./api/v1/device/addCommInterface",this.$axios({method:"post",url:t,data:e.form,headers:{token:this.$store.getters.token}}).then((function(t){var r=t.data;"0"===r.Code?e.addVisible=!1:"1"===r.Code?e.$message.error(r.Message):"-1"===r.Code?(e.$message.error(r.Message),e.$store.dispatch("user/resetToken"),e.$router.push("/login?redirect=".concat(e.$route.fullPath))):e.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(t){e.$message.error("出错了"+JSON.stringify(t))}))}}}),n=i,s=(r("22ec"),r("2877")),l=Object(s["a"])(n,o,a,!1,null,"cb7f4102",null);t["default"]=l.exports}}]);