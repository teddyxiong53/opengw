(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-798ba010"],{3846:function(t,e,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},"3d3b":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:6}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{xs:24,sm:24,md:24}},[r("el-input",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"输入上报服务名称过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1)],1)],1),t._v(" "),r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:12,md:18}},[r("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{type:"primary"},on:{click:function(e){t.addVisible=!0,t.form={},t.Param={},t.title="添加上报服务",t.mode="post"}}},[t._v("添加")]),t._v(" "),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.getReportDeviceList}},[t._v("刷新")])],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},t._l(t.filtedData,(function(e,o){return r("el-col",{key:o,staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:12,md:8}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v(t._s(e.ServiceName))]),t._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return t.handelGetDeviceListByReportService(e)}}},[t._v("上报结点")]),t._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return t.editReportService(e)}}},[t._v("修改")]),t._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return t.deleteReportService(e)}}},[t._v("删除")])],1),t._v(" "),r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("协议类型：")])]),t._v(" "),r("el-col",{attrs:{xs:16,sm:16,md:16}},[r("el-tag",{attrs:{type:t._f("statusFilter")(e.Protocol)}},[t._v(t._s(t._f("ProtocolFilter")(e.Protocol)))])],1)],1),t._v(" "),r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("上报地址：")])]),t._v(" "),r("el-col",{attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.IP))])])],1),t._v(" "),r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("上报端口：")])]),t._v(" "),r("el-col",{attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.Port))])])],1),t._v(" "),r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("上报周期：")])]),t._v(" "),r("el-col",{attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.ReportTime))])])],1),t._v(" "),r("el-collapse",{attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[e.Param?r("el-collapse-item",{attrs:{title:"详细参数",name:e.ServiceName}},[e.Param&&"Aliyun.MQTT"==e.Protocol?r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center","text-align":"right"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("产品秘钥：")])]),t._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.Param.ProductKey))])])],1):t._e(),t._v(" "),e.Param&&"Aliyun.MQTT"==e.Protocol?r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center","text-align":"right"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("设备名称：")])]),t._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.Param.DeviceName))])])],1):t._e(),t._v(" "),e.Param&&"Aliyun.MQTT"==e.Protocol?r("el-row",{staticClass:"text item"},[r("el-col",{staticStyle:{"align-self":"center","text-align":"right"},attrs:{xs:8,sm:8,md:8}},[r("span",[t._v("设备秘钥：")])]),t._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:16,sm:16,md:16}},[r("span",[t._v(t._s(e.Param.DeviceSecret))])])],1):t._e()],1):t._e()],1)],1)],1)})),1),t._v(" "),r("el-dialog",{attrs:{title:t.title,visible:t.addVisible,width:"30%"},on:{"update:visible":function(e){t.addVisible=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"服务名称"}},[r("el-input",{model:{value:t.form.ServiceName,callback:function(e){t.$set(t.form,"ServiceName",e)},expression:"form.ServiceName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"上报地址"}},[r("el-input",{model:{value:t.form.IP,callback:function(e){t.$set(t.form,"IP",e)},expression:"form.IP"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"上报端口"}},[r("el-input",{attrs:{type:"number"},model:{value:t.form.Port,callback:function(e){t.$set(t.form,"Port",e)},expression:"form.Port"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"上报周期"}},[r("el-input",{attrs:{type:"number"},model:{value:t.form.ReportTime,callback:function(e){t.$set(t.form,"ReportTime",t._n(e))},expression:"form.ReportTime"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"协议类型"}},[r("el-select",{attrs:{clearable:"",placeholder:"协议类型"},model:{value:t.form.Protocol,callback:function(e){t.$set(t.form,"Protocol",e)},expression:"form.Protocol"}},t._l(t.ProtocolList,(function(t,e){return r("el-option",{key:e,attrs:{label:t.text,value:t.id}})})),1)],1),t._v(" "),"Aliyun.MQTT"==t.form.Protocol?r("el-form-item",{attrs:{label:"输入产品秘钥"}},[r("el-input",{attrs:{placeholder:"请输入ProductKey"},model:{value:t.Param.ProductKey,callback:function(e){t.$set(t.Param,"ProductKey",e)},expression:"Param.ProductKey"}})],1):t._e(),t._v(" "),"Aliyun.MQTT"==t.form.Protocol?r("el-form-item",{attrs:{label:"输入设备名称"}},[r("el-input",{attrs:{placeholder:"请输入DeviceName"},model:{value:t.Param.DeviceName,callback:function(e){t.$set(t.Param,"DeviceName",e)},expression:"Param.DeviceName"}})],1):t._e(),t._v(" "),"Aliyun.MQTT"==t.form.Protocol?r("el-form-item",{attrs:{label:"输入设备秘钥"}},[r("el-input",{attrs:{placeholder:"请输入DeviceSecret"},model:{value:t.Param.DeviceSecret,callback:function(e){t.$set(t.Param,"DeviceSecret",e)},expression:"Param.DeviceSecret"}})],1):t._e()],1),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.addVisible=!1,t.form={}}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.operatorReportService}},[t._v("确 定")])],1)],1)],1)},a=[],s=(r("6b54"),{filters:{statusFilter:function(t){var e={"Aliyun.MQTT":"success",EMQX:"gray",TcpServer:"danger"};return e[t]||"info"},ProtocolFilter:function(t){var e={"Aliyun.MQTT":"阿里云mqtt服务",EMQX:"EMQX服务",TcpServer:"Tcp服务端"};return e[t]||"未知"},parityFilter:function(t){return"N"===t?"无校验":"J"===t?"奇校验":"O"===t?"偶校验":"未知"}},data:function(){return{serialList:[],listLoading:!0,form:{},filterText:"",editVisible:!1,baudRateList:[],ParityList:[],ProtocolList:[],addVisible:!1,reportSeviceMap:[],activeNames:"11",Param:{},title:"",mode:""}},computed:{filtedData:function(){var t=this;return this.reportSeviceMap.filter((function(e){if(e.ServiceName.toString().indexOf(t.filterText)>-1)return e}))}},created:function(){this.getReportDeviceList(),this.ProtocolList=[{id:"Aliyun.MQTT",text:"阿里云mqtt服务"},{id:"EMQX",text:"EMQX服务"}]},methods:{getReportDeviceList:function(){var t=this,e="";e="./api/v1/report/param",this.$axios({method:"get",url:e,headers:{token:this.$store.getters.token}}).then((function(e){var r=e.data;"0"===r.Code?(t.reportSeviceMap=r.Data,t.$message.success("获取上报服务列表成功")):"1"===r.Code?t.$message.error(r.Message):"-1"===r.Code?(t.$message.error(r.Message),t.$store.dispatch("user/resetToken"),t.$router.push("/login?redirect=".concat(t.$route.fullPath))):t.$message.error("返回未知错误，错误码："+r.Code)})).catch((function(e){t.$message.error("出错了"+JSON.stringify(e))}))},selectProtocol:function(t){console.log(t)},handleEdit:function(t,e){this.form=e,this.editVisible=!0},operatorReportService:function(){var t="",e={};if("Aliyun.MQTT"===this.form.Protocol&&"post"===this.mode)t="param",e.ServiceName=this.form.ServiceName,e.IP=this.form.IP,e.Port=this.form.Port.toString(),e.ReportTime=this.form.ReportTime,e.Protocol=this.form.Protocol,e.Param=this.Param;else{if("Aliyun.MQTT"!==this.form.Protocol||"delete"!==this.mode)return void this.$message.error("协议或者请求模式错误");t="param",e.ServiceName=this.form.ServiceName}var r=this,o="";o="./api/v1/report/"+t,this.$axios({method:r.mode,url:o,data:e,headers:{token:this.$store.getters.token}}).then((function(t){var e=t.data;"0"===e.Code?(r.addVisible=!1,"post"===r.mode&&r.$message.success("添加(修改)上报服务成功"),"delete"===r.mode&&r.$message.success("删除上报服务成功")):"1"===e.Code?r.$message.error(e.Message):"-1"===e.Code?(r.$message.error(e.Message),r.$store.dispatch("user/resetToken"),r.$router.push("/login?redirect=".concat(r.$route.fullPath))):r.$message.error("返回未知错误，错误码："+e.Code)})).catch((function(t){r.$message.error("出错了"+JSON.stringify(t))}))},handelGetDeviceListByReportService:function(t){this.$router.push({name:"reportDeviceManager",params:{ServiceName:t.ServiceName,Protocol:t.Protocol}})},editReportService:function(t){var e=this;this.form={},this.Param={},this.addVisible=!0,this.form=t,this.$set(e.form,"ServiceName",t.ServiceName),this.$set(e.form,"Protocol",t.Protocol),this.Param=t.Param,this.title="修改上报服务",this.mode="post"},deleteReportService:function(t){var e=this,r=this;this.$messageBox.confirm("你确定要删除上报服务吗？<br /><h3>"+t.ServiceName+"</h3>","删除上报",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,dangerouslyUseHTMLString:!0,type:"info"}).then((function(o){"confirm"===o&&(e.form={},e.Param={},e.form=t,e.$set(r.form,"ServiceName",t.ServiceName),e.$set(r.form,"Protocol",t.Protocol),e.Param=t.Param,e.mode="delete",r.operatorReportService())})).catch((function(t){"cancel"===t&&console.log("cancel")}))}}}),i=s,l=(r("509a"),r("2877")),c=Object(l["a"])(i,o,a,!1,null,"cbc67d4c",null);e["default"]=c.exports},"509a":function(t,e,r){"use strict";var o=r("8042"),a=r.n(o);a.a},"6b54":function(t,e,r){"use strict";r("3846");var o=r("cb7c"),a=r("0bfb"),s=r("9e1e"),i="toString",l=/./[i],c=function(t){r("2aba")(RegExp.prototype,i,t,!0)};r("79e5")((function(){return"/a/b"!=l.call({source:"a",flags:"b"})}))?c((function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!s&&t instanceof RegExp?a.call(t):void 0)})):l.name!=i&&c((function(){return l.call(this)}))},8042:function(t,e,r){}}]);